SELECT PRODUCT.PRODUCT_ID AS 'PRODUCT.PRODUCT_ID',
       PRODUCT.MAKER_ID AS 'PRODUCT.MAKER_ID',
       PRODUCT.PRODUCT_NAME AS 'PRODUCT.PRODUCT_NAME',
       PRODUCT.SHORT_DESCRIPTION AS 'PRODUCT.SHORT_DESCRIPTION',
       PRODUCT.LONG_DESCRIPTION AS 'PRODUCT.LONG_DESCRIPTION',
       PRODUCT.CATEGORY AS 'PRODUCT.CATEGORY',
       PRODUCT.NEED_COLD_STORAGE AS 'PRODUCT.NEED_COLD_STORAGE',
       PRODUCT.BUY_PRICE AS 'PRODUCT.BUY_PRICE',
       PRODUCT.SELL_PRICE AS 'PRODUCT.SELL_PRICE',
       PRODUCT.IMAGE AS 'PRODUCT.IMAGE',
       PRODUCT_MAKER.MAKER_ID AS 'PRODUCT_MAKER.MAKER_ID',
       PRODUCT_MAKER.ADDRESS_ID AS 'PRODUCT_MAKER.ADDRESS_ID',
       PRODUCT_MAKER.FIRM_NAME AS 'PRODUCT_MAKER.FIRM_NAME',
       PRODUCT_MAKER.TELEPHONE_NO AS 'PRODUCT_MAKER.TELEPHONE_NO',
       PRODUCT_MAKER.E_MAIL AS 'PRODUCT_MAKER.E_MAIL',
       PRODUCT_MAKER_ADDRESS.ADDRESS_ID AS 'PRODUCT_MAKER_ADDRESS.ADDRESS_ID',
       PRODUCT_MAKER_ADDRESS.COUNTRY AS 'PRODUCT_MAKER_ADDRESS.COUNTRY',
       PRODUCT_MAKER_ADDRESS.TOWN AS 'PRODUCT_MAKER_ADDRESS.TOWN',
       PRODUCT_MAKER_ADDRESS.POSTAL_CODE AS 'PRODUCT_MAKER_ADDRESS.POSTAL_CODE',
       PRODUCT_MAKER_ADDRESS.BUILDING_NO AS 'PRODUCT_MAKER_ADDRESS.BUILDING_NO',
       PRODUCT_MAKER_ADDRESS.STREET AS 'PRODUCT_MAKER_ADDRESS.STREET',
       PRODUCT_MAKER_ADDRESS.APARTMENT_NO AS 'PRODUCT_MAKER_ADDRESS.APARTMENT_NO'
FROM `PRODUCT`
JOIN `MAKER` as `PRODUCT_MAKER` ON `PRODUCT`.`MAKER_ID` = `PRODUCT_MAKER`.`MAKER_ID`
JOIN `ADDRESS` as `PRODUCT_MAKER_ADDRESS` ON `PRODUCT_MAKER`.`ADDRESS_ID` = `PRODUCT_MAKER_ADDRESS`.`ADDRESS_ID`
WHERE `PRODUCT`.`PRODUCT_ID` IN (
    SELECT `PRODUCT_BATCH`.`PRODUCT_ID`
    FROM `PRODUCT_BATCH`
    JOIN `PRODUCT_IN_STORAGE` ON `PRODUCT_BATCH`.`BATCH_ID` = `PRODUCT_IN_STORAGE`.`BATCH_ID`
    WHERE `PRODUCT_BATCH`.`EAT_BY_DATE` > date('now','+14 day')
    GROUP BY `PRODUCT_BATCH`.`BATCH_ID`
    HAVING SUM(`PRODUCT_IN_STORAGE`.`QUANTITY`) > 0);