IF (
    SELECT `PRODUCT_BATCH`.`DISCOUNT`
    FROM `PRODUCT_BATCH`
    WHERE `PRODUCT_BATCH`.`BATCH_ID` = ?
    LIMIT 1) IS NULL
THEN
    SELECT `PRODUCT`.`SELL_PRICE` `RESULT`
    FROM `PRODUCT_IN_STORAGE`
    JOIN `PRODUCT_BATCH` ON `PRODUCT_IN_STORAGE`.`BATCH_ID` = `PRODUCT_BATCH`.`BATCH_ID`
    JOIN `PRODUCT` ON `PRODUCT_BATCH`.`PRODUCT_ID` = `PRODUCT`.`PRODUCT_ID`
    WHERE `PRODUCT_BATCH`.`BATCH_ID` = ?
    LIMIT 1;
ELSE
    SELECT (`PRODUCT`.`SELL_PRICE` * (100 - `PRODUCT_BATCH`.`DISCOUNT`) / 100) `RESULT`
    FROM `PRODUCT_IN_STORAGE`
    JOIN `PRODUCT_BATCH` ON `PRODUCT_IN_STORAGE`.`BATCH_ID` = `PRODUCT_BATCH`.`BATCH_ID`
    JOIN `PRODUCT` ON `PRODUCT_BATCH`.`PRODUCT_ID` = `PRODUCT`.`PRODUCT_ID`
    WHERE `PRODUCT_BATCH`.`BATCH_ID` = ?
    LIMIT 1;
END IF;