SELECT *
FROM `STORAGE`
JOIN `ADDRESS` `STORAGE_ADDRESS` ON `STORAGE`.`ADDRESS_ID` = `STORAGE_ADDRESS`.`ADDRESS_ID`
JOIN `EMPLOYEE` `STORAGE_EMPLOYEE` ON `STORAGE`.`MANAGER_ID` = `STORAGE_EMPLOYEE`.`EMPLOYEE_ID`
JOIN `USER` `STORAGE_EMPLOYEE_USER` ON `STORAGE_EMPLOYEE`.`USER_ID` = `STORAGE_EMPLOYEE_USER`.`USER_ID`
WHERE `STORAGE_ID` = (
    SELECT `STORAGE_ID`
    FROM `PRODUCT_IN_STORAGE`
    JOIN `PRODUCT_BATCH` `IN_STORAGE` ON `PRODUCT_IN_STORAGE`.`BATCH_ID` = `IN_STORAGE`.`BATCH_ID`
    JOIN `PRODUCT_BATCH` `IN_ORDER` ON `PRODUCT_IN_STORAGE`.`BATCH_ID` = ?
    WHERE `PRODUCT_IN_STORAGE`.`BATCH_ID` = ?
    AND `IN_STORAGE`.`EAT_BY_DATE` = `IN_ORDER`.`EAT_BY_DATE`
    LIMIT 1);